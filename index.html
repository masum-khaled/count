<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hours Calculator</title>
    <style>
        /* General Body Styling */
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #f9f9f9;
            color: #333;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100vh;
            margin: 0;
        }

        /* Tab Button Styling */
        .tab {
            display: flex;
            justify-content: center;
            background-color: #333;
        }

        .tab button {
            flex: 1;
            background-color: inherit;
            border: none;
            outline: none;
            cursor: pointer;
            padding: 14px 16px;
            color: white;
            font-size: 17px;
            text-align: center;
        }

        .tab button:hover {
            background-color: #575757;
        }

        .tab button.active {
            background-color: #007bff;
        }

        /* Tab Content */
        .tabcontent {
            display: none;
            padding: 20px;
            margin: 0 auto;
            width: 100%;
            max-width: 600px;
            background-color: #ffffff;
            border: 1px solid #ddd;
            border-radius: 8px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
        }

        /* Textarea */
        textarea {
            width: 100%;
            height: 150px;
            padding: 10px;
            margin-bottom: 15px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 16px;
        }

        /* Buttons */
        button {
            display: block;
            width: 100%;
            padding: 12px;
            margin: 5px 0;
            color: #fff;
            font-size: 16px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            transition: background-color 0.3s ease;
        }

        button:hover {
            opacity: 0.9;
        }

        button[onclick="autoCalculate()"],
        button[onclick="manualCalculate()"] {
            background-color: #007bff;
        }

        button[onclick="clearManual()"],
        button[onclick="clearAuto()"] {
            background-color: #dc3545;
        }

        .results {
            text-align: left;
            font-size: 16px;
            margin-top: 15px;
            border-top: 1px solid #ddd;
            padding-top: 10px;
        }

        /* Copy Button Styling */
        .copy-btn {
            width: 100%;
            padding: 12px;
            background-color: #28a745;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            margin-top: 10px;
            display: none;
            font-size: 16px;
            transition: background-color 0.3s ease;
        }

        .copy-btn:hover {
            background-color: #218838;
        }

        /* Footer Styling */
        footer {
            background-color: #dc3545;
            color: white;
            text-align: center;
            padding: 20px;
            position: fixed;
            width: 100%;
            bottom: 0;
        }

    </style>
</head>
<body>

  <!-- Tab Buttons -->
  <div class="tab">
    <button class="tablinks" onclick="openTab(event, 'auto')" id="defaultOpen">Auto</button>
    <button class="tablinks" onclick="openTab(event, 'manual')">Manual</button>
  </div>

  <!-- Auto Hours Calculator -->
  <div id="auto" class="tabcontent">
    <h2>Auto Hours Calculator</h2>
    <textarea id="inputSchedule" placeholder="Paste your schedule here (e.g., 09:00-12:00, 13:00-15:00)"></textarea>
    <button onclick="calculateHours()">Calculate Total Hours</button>
    <div class="result" id="result"></div>
    <button class="copy-btn" id="copyBtn" onclick="copyToClipboard()">Copy Result</button>
  </div>

  <!-- Manual Hours Calculator -->
  <div id="manual" class="tabcontent">
    <h2>Manual Hours Calculator</h2>
    <div id="manual_fields">
      <div class="time-row">
        <label>Start</label>
        <input type="time" class="start_time">
        <label>End</label>
        <input type="time" class="end_time">
      </div>
    </div>
    <button onclick="addRow()">+ Add More Lines</button>
    <button onclick="manualCalculate()">Calculate</button>
    <button onclick="clearManual()">Clear</button>
    <div id="manual_result" class="results"></div>
  </div>

  <footer>
    Created by <a href="https://www.linkedin.com/in/masumkhaled" target="_blank">Masum Khaled</a>
  </footer>

  <script>
    // Open Tab Functionality
    function openTab(evt, tabName) {
      var i, tabcontent, tablinks;
      tabcontent = document.getElementsByClassName("tabcontent");
      for (i = 0; i < tabcontent.length; i++) {
        tabcontent[i].style.display = "none";
      }
      tablinks = document.getElementsByClassName("tablinks");
      for (i = 0; i < tablinks.length; i++) {
        tablinks[i].className = tablinks[i].className.replace(" active", "");
      }
      document.getElementById(tabName).style.display = "block";
      evt.currentTarget.className += " active";
    }

    // Auto Hours Calculator Functions
    function parseTime(time) {
      if (time === '00h' || time === '00:00') {
        return 24 * 60; // Treat 00h or 00:00 as 24h
      }
      if (time.includes('h')) {
        let [hours, minutes] = time.split('h').map(Number);
        if (isNaN(minutes)) minutes = 0;
        return hours * 60 + minutes;
      } else {
        const [hours, minutes] = time.split(':').map(Number);
        return hours * 60 + minutes;
      }
    }

    function parseTimeRange(timeRange) {
      const cleanedRange = timeRange.replace(/\s+/g, '-'); // Replace spaces with hyphens
      const [start, end] = cleanedRange.split('-').map(parseTime);

      // Handle cases where the end time is less than the start time (e.g., 17h30-00h30)
      const adjustedEnd = end <= start ? end + 24 * 60 : end;

      return (adjustedEnd - start) / 60;
    }

    function calculateHours() {
      let input = document.getElementById('inputSchedule').value;
      input = input.replace(/\s+/g, ' ').trim(); // Normalize whitespace
      const timeRanges = input.match(/\d{1,2}[:h]?\d{0,2}(?:\s|-)\d{1,2}[:h]?\d{0,2}/g) || [];

      let totalHours = 0;
      let resultText = '';
      timeRanges.forEach(range => {
        const hours = parseTimeRange(range);
        resultText += `${range}, Hours: ${hours.toFixed(2)}\n`;
        totalHours += hours;
      });
      resultText += `\nTotal Hours: ${totalHours.toFixed(2)}`;
      
      document.getElementById('result').innerText = resultText;
      document.getElementById('copyBtn').style.display = 'block'; // Show the copy button
    }

    function copyToClipboard() {
      const resultText = document.getElementById('result').innerText;
      navigator.clipboard.writeText(resultText).then(() => {
        alert('Result copied to clipboard');
      });
    }

    // Manual Hours Calculator Functions
    function addRow() {
      const container = document.getElementById("manual_fields");
      const row = document.createElement("div");
      row.className = "time-row";
      row.innerHTML = `
        <label>Start</label>
        <input type="time" class="start_time">
        <label>End</label>
        <input type="time" class="end_time">
      `;
      container.appendChild(row);
    }

    function manualCalculate() {
      const rows = document.querySelectorAll("#manual_fields .time-row");
      let totalMinutes = 0;
      const resultDiv = document.getElementById("manual_result");
      resultDiv.innerHTML = ""; // Clear previous results

      rows.forEach((row, index) => {
        const start = row.querySelector(".start_time").value;
        const end = row.querySelector(".end_time").value;

        if (start && end) {
          const [startH, startM] = start.split(":").map(Number);
          const [endH, endM] = end.split(":").map(Number);
          const blockMinutes = (endH * 60 + endM) - (startH * 60 + startM);
          totalMinutes += blockMinutes;

          const hours = Math.floor(blockMinutes / 60);
          const minutes = blockMinutes % 60;

          resultDiv.innerHTML += `Line ${index + 1}: ${hours} Hours, ${minutes} Minutes<br>`;
        }
      });

      const totalHours = Math.floor(totalMinutes / 60);
      const totalMinutesRemaining = totalMinutes % 60;
      resultDiv.innerHTML += `<b>Total Time: ${totalHours} Hours, ${totalMinutesRemaining} Minutes</b>`;
    }

    function clearManual() {
      document.getElementById("manual_fields").innerHTML = `
        <div class="time-row">
          <label>Start</label>
          <input type="time" class="start_time">
          <label>End</label>
          <input type="time" class="end_time">
        </div>
      `;
      document.getElementById("manual_result").textContent = "";
    }

    // Set Default Tab
    document.getElementById("defaultOpen").click();
  </script>

</body>
</html>
